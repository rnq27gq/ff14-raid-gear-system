# FF14 零式装備分配システム

<div align="center">

**FF14の零式レイドで装備を公平に分配するためのWebアプリケーション**

[![Live Demo](https://img.shields.io/badge/Live-Demo-blue?style=for-the-badge)](https://rnq27gq.github.io/ff14-raid-gear-system/)
[![Discord](https://img.shields.io/badge/Discord-Bot-5865F2?style=for-the-badge&logo=discord&logoColor=white)](https://discord.com)

</div>

---

## 📖 目次

- [特徴](#-特徴)
- [クイックスタート](#-クイックスタート)
- [詳しい使い方](#-詳しい使い方)
- [分配システムの仕組み](#-分配システムの仕組み)
- [よくある質問](#-よくある質問)

---

## ✨ 特徴

- **🤖 Discord Bot連携** - `/share`コマンドで簡単にチーム専用URLを作成
- **🎯 自動分配提案** - 装備方針・優先度・取得履歴から最適な分配先を自動計算
- **📊 統計管理** - プレイヤー別の取得状況を一目で確認
- **⚡ リアルタイム同期** - Supabaseによるデータのリアルタイム保存
- **💰 断章交換対応** - 断章で交換した装備を考慮した分配ロジック
- **📱 レスポンシブ対応** - PC・スマホどちらでも快適に利用可能

---

## 🚀 クイックスタート

### 1. Discordで専用URLを作成

DiscordサーバーでDiscord Botの `/share` コマンドを実行します。

![Discord /share コマンド](SS/share5.png)

専用URLが生成されます。このURLをチームメンバーに共有してください。

```
例: https://rnq27gq.github.io/ff14-raid-gear-system/?token=xxxx-xxxx-xxxx
```

### 2. 専用URLにアクセス

共有されたURLをクリックすると、トップページが表示されます。

![トップページ](SS/toppage1.png)

### 3. メンバー情報を設定

メンバー設定ブロックで8人分の情報を入力します：

- **名前**: プレイヤー名
- **ジョブ**: 各メンバーのジョブ
- **装備方針**: 零式装備を取得したい部位に〇をつける（空白=トームストーン装備で可）
- **武器希望**: 第2・第3希望の武器を設定

すべて入力したら「設定完了」をクリック。

---

## 📚 詳しい使い方

### 装備分配の実行

1. ダッシュボードで **[1層] [2層] [3層] [4層]** のいずれかをクリック
2. ドロップしたアイテムをチェック

![分配計算画面](SS/calc3.png)

3. システムが自動的に最適な分配先を提案します

![分配結果画面](SS/result4.png)

- **緑色**: 最優先の推奨プレイヤー
- **Need**: 零式装備を希望している
- **Greed**: トームストーン装備可だがロット可能
- **Pass**: 取得済みまたはロット対象外

4. 「分配確定」をクリックで履歴に記録されます

### 統計情報の確認

「統計情報」ボタンをクリックすると、プレイヤー別の取得状況が表示されます。

- **緑色（取得済）**: ドロップで取得
- **黄色（断章交換）**: 断章で交換済み、ドロップ未取得
- **青色（断章交換・箱取得済）**: 断章交換後、ドロップも取得

### 配布履歴の確認

「配布履歴」ボタンをクリックすると、過去の分配記録を確認できます。

![配布履歴](SS/history6.png)

フィルター機能：
- **週**: 週ごとにフィルター
- **層**: 1層〜4層でフィルター
- **装備部位**: 特定部位でフィルター
- **取得者**: 特定プレイヤーでフィルター

各データの右端にある「削除」ボタンで誤った記録を削除できます。

---

## ⚙️ 分配システムの仕組み

### 優先度計算

システムは以下の要素で分配優先度を自動計算します：

1. **装備方針**
   - 零式方針（〇）: Need判定（優先度高）
   - トームストーン方針（空白）: Greed判定（優先度低）

2. **ポジション優先度**
   - デフォルト: MT → ST → D1 → D2 → D3 → D4 → H1 → H2
   - ドラッグ&ドロップで変更可能

3. **取得履歴**
   - 過去の取得数が少ないプレイヤーを優先
   - 動的優先度による自動調整

4. **武器希望順位**
   - 第1希望 > 第2希望 > 第3希望の順に優先

### 断章交換システム

断章で装備を交換したプレイヤーの特別処理：

```
統計情報 → 編集開始 → プルダウンで「断章交換」を選択
```

**動作ルール:**
- ✅ 零式方針で未取得のプレイヤーがいる間は分配対象外
- ✅ 全員に行き渡ったら分配対象に復帰
- ✅ ドロップ装備を取得すると「断章交換・箱取得済」に自動更新され完全除外

**8週クリア時の理想状態:**
- 全員が「緑色（取得済）」または「青色（断章交換・箱取得済）」

---

## ❓ よくある質問

### Q: 専用URLを紛失した場合は？

A: Discordで再度 `/share` コマンドを実行してください。新しいURLが生成されます。

### Q: メンバーを途中で変更できる？

A: 可能です。メンバー設定ブロックから編集して「設定完了」をクリックしてください。

### Q: データは自動保存される？

A: はい。すべての変更は即座にSupabaseに保存されます。手動保存は不要です。

### Q: 間違って分配を確定してしまった場合は？

A: 配布履歴画面の「削除」ボタンで該当記録を削除できます。または統計情報の「編集開始」から手動修正も可能です。

### Q: 週数が正しく表示されない

A: 週数はチーム作成日から自動計算されます。リンク作成から日数が経過すると自動的に2週目、3週目とインクリメントします。

### Q: 複数のレイドティアを管理できる？

A: 1つのチームにつき1つのレイドティアです。新しいパッチの零式が始まる場合は、新しいチームを作成してください。

### Q: スマートフォンでも使える？

A: はい。レスポンシブデザインに対応しており、スマホでも快適に利用できます。

---

## 🛠️ 技術スタック

- **フロントエンド**: Vanilla JavaScript, HTML5, CSS3
- **バックエンド**: Supabase (PostgreSQL)
- **認証**: Discord OAuth2
- **ホスティング**: GitHub Pages
- **Discord Bot**: Discord.js v14

---

## 📝 ライセンス

MIT License

---

## 👤 開発者

**hirqt** | 2025年

ファイナルファンタジーXIVレイドコミュニティのために設計

---

<div align="center">

**🎮 良いレイドライフを！ 🎮**

</div>
